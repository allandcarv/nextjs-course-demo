{"ast":null,"code":"import { MongoClient, ObjectId } from 'mongodb';\n\nconst connection = async collection => {\n  const client = new MongoClient('mongodb+srv://react-course:react-course-pass@cluster0.7s65w.mongodb.net/meetups?retryWrites=true&w=majority');\n  await client.connect();\n  const db = client.db();\n  const conn = db.collection(collection);\n  return {\n    conn,\n    client\n  };\n};\n\nexport const find = async (collection, property) => {\n  const {\n    conn,\n    client\n  } = await connection(collection);\n  const params = property && {\n    [property]: 1\n  };\n  const result = await conn.distinct(\"_id\", {}).toArray();\n  client.close();\n  return result;\n};\nexport const findOne = async (collection, filter) => {\n  const {\n    conn,\n    client\n  } = await connection(collection);\n  const parsedFilter = Object.keys(filter).reduce((final, key) => {\n    if (key === '_id') {\n      final[key] = new ObjectId(filter[key]);\n    } else {\n      final[key] = filter[key];\n    }\n\n    return final;\n  }, {});\n  const result = await conn.findOne(parsedFilter);\n  client.close();\n  return result;\n};\nexport const insertOne = async (collection, data) => {\n  const {\n    conn,\n    client\n  } = await connection(collection);\n  const result = await conn.insertOne(data);\n  client.close();\n  return result;\n};","map":{"version":3,"sources":["/Users/allan.carvalho/workspace/courses/react/complete-guide/section-23_next-js/nextjs-project/shared/util/db.js"],"names":["MongoClient","ObjectId","connection","collection","client","connect","db","conn","find","property","params","result","distinct","toArray","close","findOne","filter","parsedFilter","Object","keys","reduce","final","key","insertOne","data"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,QAAtB,QAAsC,SAAtC;;AAEA,MAAMC,UAAU,GAAG,MAAOC,UAAP,IAAsB;AACrC,QAAMC,MAAM,GAAG,IAAIJ,WAAJ,CAAgB,6GAAhB,CAAf;AAEA,QAAMI,MAAM,CAACC,OAAP,EAAN;AAEA,QAAMC,EAAE,GAAGF,MAAM,CAACE,EAAP,EAAX;AAEA,QAAMC,IAAI,GAAGD,EAAE,CAACH,UAAH,CAAcA,UAAd,CAAb;AAEA,SAAO;AAAEI,IAAAA,IAAF;AAAQH,IAAAA;AAAR,GAAP;AACH,CAVD;;AAYA,OAAO,MAAMI,IAAI,GAAG,OAAOL,UAAP,EAAmBM,QAAnB,KAAgC;AAChD,QAAM;AAAEF,IAAAA,IAAF;AAAQH,IAAAA;AAAR,MAAmB,MAAMF,UAAU,CAACC,UAAD,CAAzC;AAEA,QAAMO,MAAM,GAAGD,QAAQ,IAAK;AAAE,KAACA,QAAD,GAAY;AAAd,GAA5B;AAEA,QAAME,MAAM,GAAG,MAAMJ,IAAI,CAACK,QAAL,CAAc,KAAd,EAAqB,EAArB,EAAyBC,OAAzB,EAArB;AAEAT,EAAAA,MAAM,CAACU,KAAP;AAEA,SAAOH,MAAP;AACH,CAVM;AAYP,OAAO,MAAMI,OAAO,GAAG,OAAOZ,UAAP,EAAmBa,MAAnB,KAA8B;AACjD,QAAM;AAAET,IAAAA,IAAF;AAAQH,IAAAA;AAAR,MAAmB,MAAMF,UAAU,CAACC,UAAD,CAAzC;AAEA,QAAMc,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYH,MAAZ,EAAoBI,MAApB,CAA2B,CAACC,KAAD,EAAQC,GAAR,KAAgB;AAC5D,QAAIA,GAAG,KAAK,KAAZ,EAAmB;AACfD,MAAAA,KAAK,CAACC,GAAD,CAAL,GAAa,IAAIrB,QAAJ,CAAae,MAAM,CAACM,GAAD,CAAnB,CAAb;AACH,KAFD,MAEO;AACHD,MAAAA,KAAK,CAACC,GAAD,CAAL,GAAaN,MAAM,CAACM,GAAD,CAAnB;AACH;;AAED,WAAOD,KAAP;AACH,GARoB,EAQlB,EARkB,CAArB;AAUA,QAAMV,MAAM,GAAG,MAAMJ,IAAI,CAACQ,OAAL,CAAaE,YAAb,CAArB;AAEAb,EAAAA,MAAM,CAACU,KAAP;AAEA,SAAOH,MAAP;AACH,CAlBM;AAoBP,OAAO,MAAMY,SAAS,GAAG,OAAOpB,UAAP,EAAmBqB,IAAnB,KAA4B;AACjD,QAAM;AAAEjB,IAAAA,IAAF;AAAQH,IAAAA;AAAR,MAAmB,MAAMF,UAAU,CAACC,UAAD,CAAzC;AAEA,QAAMQ,MAAM,GAAG,MAAMJ,IAAI,CAACgB,SAAL,CAAeC,IAAf,CAArB;AAEApB,EAAAA,MAAM,CAACU,KAAP;AAEA,SAAOH,MAAP;AACH,CARM","sourcesContent":["import { MongoClient, ObjectId } from 'mongodb';\n\nconst connection = async (collection) => {\n    const client = new MongoClient('mongodb+srv://react-course:react-course-pass@cluster0.7s65w.mongodb.net/meetups?retryWrites=true&w=majority')\n\n    await client.connect();\n\n    const db = client.db();\n\n    const conn = db.collection(collection);\n\n    return { conn, client };\n}\n\nexport const find = async (collection, property) => {\n    const { conn, client } = await connection(collection);\n\n    const params = property && ({ [property]: 1 } );\n\n    const result = await conn.distinct(\"_id\", {}).toArray();\n\n    client.close();\n\n    return result;\n}\n\nexport const findOne = async (collection, filter) => {\n    const { conn, client } = await connection(collection);\n\n    const parsedFilter = Object.keys(filter).reduce((final, key) => {\n        if (key === '_id') {\n            final[key] = new ObjectId(filter[key]);\n        } else {\n            final[key] = filter[key]\n        }\n\n        return final;\n    }, {});\n    \n    const result = await conn.findOne(parsedFilter);\n\n    client.close();\n\n    return result;\n}\n\nexport const insertOne = async (collection, data) => {\n    const { conn, client } = await connection(collection);\n\n    const result = await conn.insertOne(data);\n\n    client.close();\n\n    return result;\n}"]},"metadata":{},"sourceType":"module"}